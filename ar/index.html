<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <title>Time Portals AR</title>
    
    <script src="https://cdn.jsdelivr.net/gh/aframevr/aframe@1c2407b26c61958baa93967b5412487cd94b290b/dist/aframe-master.min.js"></script>
    <script src="https://raw.githack.com/AR-js-org/AR.js/master/aframe/build/aframe-ar-nft.js"></script>
    
    <style>
        body { margin: 0; overflow: hidden; }
        
        #loading {
            position: fixed;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.9);
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 9999;
            color: white;
            font-family: Arial, sans-serif;
        }
        
        #loading h2 { font-size: 24px; margin-bottom: 15px; }
        #loading p { font-size: 14px; color: #aaa; }
        
        .info-panel {
            position: fixed;
            top: 10px;
            left: 50%;
            transform: translateX(-50%);
            background: rgba(0,0,0,0.8);
            color: white;
            padding: 12px 20px;
            border-radius: 8px;
            font-family: Arial;
            font-size: 15px;
            z-index: 100;
            text-align: center;
            max-width: 90%;
        }
        
        .progress-dots {
            position: fixed;
            bottom: 20px;
            left: 50%;
            transform: translateX(-50%);
            display: flex;
            gap: 12px;
            z-index: 100;
        }
        
        .dot {
            width: 25px;
            height: 25px;
            border-radius: 50%;
            background: rgba(255,255,255,0.3);
            border: 2px solid white;
            transition: all 0.3s;
        }
        
        .dot.active {
            background: #FFD700;
            box-shadow: 0 0 15px #FFD700;
            transform: scale(1.2);
        }
        
        .dot.done {
            background: #00FF00;
            border-color: #00FF00;
        }
        
        #tap-hint {
            position: fixed;
            bottom: 70px;
            left: 50%;
            transform: translateX(-50%);
            background: white;
            color: black;
            padding: 12px 25px;
            border-radius: 20px;
            font-weight: bold;
            font-size: 16px;
            display: none;
            z-index: 100;
            animation: pulse 1s infinite;
        }
        
        @keyframes pulse {
            0%, 100% { transform: translateX(-50%) scale(1); }
            50% { transform: translateX(-50%) scale(1.1); }
        }
    </style>
</head>
<body>
    <div id="loading">
        <h2>‚è≥ Loading AR...</h2>
        <p>Point camera at markers: PRIZA ‚Üí ALP ‚Üí AP</p>
    </div>
    
    <div class="info-panel" id="info" style="display:none;">
        Scan PRIZA marker
    </div>
    
    <div class="progress-dots" id="progress" style="display:none;">
        <div class="dot" id="dot1"></div>
        <div class="dot" id="dot2"></div>
        <div class="dot" id="dot3"></div>
    </div>
    
    <div id="tap-hint">üëÜ TAP SCREEN!</div>

    <a-scene
        vr-mode-ui="enabled: false"
        renderer="logarithmicDepthBuffer: true; colorManagement: true; sortObjects: true; antialias: false; precision: mediump"
        embedded
        arjs="trackingMethod: best; sourceType: webcam; debugUIEnabled: false; detectionMode: mono; maxDetectionRate: 30; canvasWidth: 640; canvasHeight: 480"
        loading-screen="enabled: false">
        
        <!-- Camera -->
        <a-camera gps-camera rotation-reader></a-camera>
        
        <!-- MARKER 1: PRIZA (Future Portal) -->
        <a-nft
            type="nft"
            url="priza"
            smooth="true"
            smoothCount="10"
            smoothTolerance="0.01"
            smoothThreshold="5"
            id="marker1"
            emitevents="true"
            registerevents="true">
            
            <a-entity id="portal1" position="0 0 0">
                <!-- Central rotating cube -->
                <a-box
                    position="0 0.5 0"
                    width="0.6" height="0.6" depth="0.6"
                    color="#00FFFF"
                    metalness="0.8"
                    roughness="0.2"
                    animation="property: rotation; to: 0 360 0; loop: true; dur: 3000; easing: linear">
                </a-box>
                
                <!-- Outer glow sphere -->
                <a-sphere
                    position="0 0.5 0"
                    radius="0.8"
                    color="#00FFFF"
                    opacity="0.2"
                    transparent="true"
                    animation="property: scale; to: 1.3 1.3 1.3; loop: true; dur: 2000; dir: alternate; easing: easeInOutQuad">
                </a-sphere>
                
                <!-- Rotating ring -->
                <a-ring
                    position="0 0.5 0"
                    rotation="90 0 0"
                    radius-inner="0.85"
                    radius-outer="1"
                    color="#00FFFF"
                    opacity="0.6"
                    animation="property: rotation; to: 90 360 0; loop: true; dur: 4000; easing: linear">
                </a-ring>
                
                <!-- Text label -->
                <a-text
                    value="FUTURE"
                    align="center"
                    position="0 1.3 0"
                    width="2"
                    color="#00FFFF">
                </a-text>
            </a-entity>
        </a-nft>
        
        <!-- MARKER 2: ALP (Ancient Portal) -->
        <a-nft
            type="nft"
            url="alp"
            smooth="true"
            smoothCount="10"
            smoothTolerance="0.01"
            smoothThreshold="5"
            id="marker2"
            emitevents="true"
            registerevents="true">
            
            <a-entity id="portal2" position="0 0 0">
                <!-- Central pulsing sphere -->
                <a-sphere
                    position="0 0.5 0"
                    radius="0.5"
                    color="#FFD700"
                    metalness="0.7"
                    roughness="0.3"
                    animation="property: scale; to: 1.2 1.2 1.2; loop: true; dur: 2000; dir: alternate; easing: easeInOutQuad">
                </a-sphere>
                
                <!-- Ring 1 -->
                <a-ring
                    position="0 0.5 0"
                    rotation="90 0 0"
                    radius-inner="0.65"
                    radius-outer="0.8"
                    color="#FFD700"
                    opacity="0.6"
                    animation="property: rotation; to: 90 360 0; loop: true; dur: 5000; easing: linear">
                </a-ring>
                
                <!-- Ring 2 -->
                <a-ring
                    position="0 0.5 0"
                    rotation="45 0 0"
                    radius-inner="0.85"
                    radius-outer="1"
                    color="#FFD700"
                    opacity="0.5"
                    animation="property: rotation; to: 45 0 360; loop: true; dur: 6000; easing: linear">
                </a-ring>
                
                <!-- Glow effect -->
                <a-sphere
                    position="0 0.5 0"
                    radius="1.2"
                    color="#FFD700"
                    opacity="0.1"
                    transparent="true"
                    animation="property: opacity; from: 0.05; to: 0.15; loop: true; dur: 1500; dir: alternate">
                </a-sphere>
                
                <!-- Text label -->
                <a-text
                    value="ANCIENT"
                    align="center"
                    position="0 1.3 0"
                    width="2"
                    color="#FFD700">
                </a-text>
            </a-entity>
        </a-nft>
        
        <!-- MARKER 3: AP (Industrial Portal) -->
        <a-nft
            type="nft"
            url="ap"
            smooth="true"
            smoothCount="10"
            smoothTolerance="0.01"
            smoothThreshold="5"
            id="marker3"
            emitevents="true"
            registerevents="true">
            
            <a-entity id="portal3" position="0 0 0">
                <!-- Central rotating cone -->
                <a-cone
                    position="0 0.6 0"
                    radius-bottom="0.5"
                    radius-top="0.2"
                    height="0.9"
                    color="#FF6600"
                    metalness="0.6"
                    roughness="0.4"
                    animation="property: rotation; to: 0 360 0; loop: true; dur: 2500; easing: linear">
                </a-cone>
                
                <!-- Torus ring -->
                <a-torus
                    position="0 0.7 0"
                    radius="0.7"
                    radius-tubular="0.1"
                    color="#FF6600"
                    opacity="0.8"
                    animation="property: rotation; to: 360 0 360; loop: true; dur: 4000; easing: linear">
                </a-torus>
                
                <!-- Outer ring -->
                <a-ring
                    position="0 0.5 0"
                    rotation="0 0 0"
                    radius-inner="0.9"
                    radius-outer="1.05"
                    color="#FF6600"
                    opacity="0.5"
                    animation="property: rotation; to: 0 360 360; loop: true; dur: 5000; easing: linear">
                </a-ring>
                
                <!-- Glow effect -->
                <a-sphere
                    position="0 0.6 0"
                    radius="1.1"
                    color="#FF6600"
                    opacity="0.15"
                    transparent="true"
                    animation="property: scale; to: 1.2 1.2 1.2; loop: true; dur: 1800; dir: alternate">
                </a-sphere>
                
                <!-- Text label -->
                <a-text
                    value="INDUSTRIAL"
                    align="center"
                    position="0 1.4 0"
                    width="2"
                    color="#FF6600">
                </a-text>
            </a-entity>
        </a-nft>
    </a-scene>

    <script>
        // Game state
        const state = {
            started: false,
            portal1Active: false,
            portal2Active: false,
            portal3Active: false,
            currentMarker: null
        };
        
        // UI elements
        const loading = document.getElementById('loading');
        const info = document.getElementById('info');
        const progress = document.getElementById('progress');
        const tapHint = document.getElementById('tap-hint');
        const dot1 = document.getElementById('dot1');
        const dot2 = document.getElementById('dot2');
        const dot3 = document.getElementById('dot3');
        
        // Markers
        const marker1 = document.getElementById('marker1');
        const marker2 = document.getElementById('marker2');
        const marker3 = document.getElementById('marker3');
        
        // Start when scene loads
        setTimeout(() => {
            loading.style.display = 'none';
            info.style.display = 'block';
            progress.style.display = 'flex';
            state.started = true;
        }, 2000);
        
        // Update UI
        function updateInfo(text) {
            info.textContent = text;
        }
        
        function showTapHint(show) {
            tapHint.style.display = show ? 'block' : 'none';
        }
        
        function updateDot(dotElement, status) {
            dotElement.className = 'dot';
            if (status === 'active') dotElement.classList.add('active');
            if (status === 'done') dotElement.classList.add('done');
        }
        
        // Tap to activate portal
        document.addEventListener('click', () => {
            if (!state.started) return;
            
            if (state.currentMarker === 1 && !state.portal1Active) {
                state.portal1Active = true;
                updateDot(dot1, 'done');
                updateInfo('‚úÖ Portal 1 activated! Find ALP marker');
                showTapHint(false);
                console.log('Portal 1 activated');
            }
            else if (state.currentMarker === 2 && state.portal1Active && !state.portal2Active) {
                state.portal2Active = true;
                updateDot(dot2, 'done');
                updateInfo('‚úÖ Portal 2 activated! Find AP marker');
                showTapHint(false);
                console.log('Portal 2 activated');
            }
            else if (state.currentMarker === 3 && state.portal2Active && !state.portal3Active) {
                state.portal3Active = true;
                updateDot(dot3, 'done');
                updateInfo('üéâ ALL PORTALS ACTIVATED!');
                showTapHint(false);
                console.log('Portal 3 activated - WIN!');
                setTimeout(() => {
                    alert('üéâ SUCCESS!\n\nAll Time Portals activated:\n‚úÖ Future\n‚úÖ Ancient\n‚úÖ Industrial\n\nGrade: 9-10 points!');
                }, 1000);
            }
        });
        
        // MARKER 1 EVENTS
        marker1.addEventListener('markerFound', () => {
            console.log('PRIZA marker found');
            if (!state.started) return;
            
            state.currentMarker = 1;
            if (!state.portal1Active) {
                updateInfo('üîµ Portal 1 - FUTURE - TAP!');
                updateDot(dot1, 'active');
                showTapHint(true);
            }
        });
        
        marker1.addEventListener('markerLost', () => {
            console.log('PRIZA marker lost');
            if (state.currentMarker === 1 && !state.portal1Active) {
                state.currentMarker = null;
                updateInfo('Point at PRIZA marker');
                showTapHint(false);
            }
        });
        
        // MARKER 2 EVENTS
        marker2.addEventListener('markerFound', () => {
            console.log('ALP marker found');
            if (!state.started) return;
            
            if (!state.portal1Active) {
                updateInfo('‚ö†Ô∏è Activate Portal 1 first!');
                return;
            }
            
            state.currentMarker = 2;
            if (!state.portal2Active) {
                updateInfo('üü° Portal 2 - ANCIENT - TAP!');
                updateDot(dot2, 'active');
                showTapHint(true);
            }
        });
        
        marker2.addEventListener('markerLost', () => {
            console.log('ALP marker lost');
            if (state.currentMarker === 2 && state.portal1Active && !state.portal2Active) {
                state.currentMarker = null;
                updateInfo('Point at ALP marker');
                showTapHint(false);
            }
        });
        
        // MARKER 3 EVENTS
        marker3.addEventListener('markerFound', () => {
            console.log('AP marker found');
            if (!state.started) return;
            
            if (!state.portal2Active) {
                updateInfo('‚ö†Ô∏è Activate Portal 2 first!');
                return;
            }
            
            state.currentMarker = 3;
            if (!state.portal3Active) {
                updateInfo('üü† Portal 3 - INDUSTRIAL - TAP!');
                updateDot(dot3, 'active');
                showTapHint(true);
            }
        });
        
        marker3.addEventListener('markerLost', () => {
            console.log('AP marker lost');
            if (state.currentMarker === 3 && state.portal2Active && !state.portal3Active) {
                state.currentMarker = null;
                updateInfo('Point at AP marker');
                showTapHint(false);
            }
        });
    </script>
</body>
</html>